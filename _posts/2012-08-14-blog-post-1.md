---
title: '推荐算法学习笔记'
date: 2025-11-10
permalink: /posts/2025/11/推荐算法学习笔记/
tags:
  - 搜广推
  - 推荐算法
---

**学习地址：[https://datawhalechina.github.io/fun-rec](https://datawhalechina.github.io/fun-rec)**

## 第一章 推荐系统是什么

**推荐系统的本质，是对关系的量化预测** —— 需要理解三个关键要素

首先是**理解用户**——用户的历史观看记录，基本画像信息（年龄、位置等），搜索关键词、点击（点赞、不敢兴趣）

接下来是**理解物品**——视频的内容属性（科技类还是娱乐类、时长多少）、统计属性（多少人看过、互动趋势如何）

最后是**理解场景**——现在是周末还是上班日、现在是一天中的哪个时间点，用户是手机观看还是平板观看等

**综上，推荐系统的核心可以抽象为一个函数：Score = f(User, Item, Context)**

![../_images/score_function.svg](https://datawhalechina.github.io/fun-rec/_images/score_function.svg)
<center>图1 推荐系统核心预测函数</center>


**推荐系统工程化面临的核心矛盾：如何在极其有限的时间内从海量的候选中找到最优的推荐结果？**

通过**召回-排序-重排**三层流水线，召回追求速度和覆盖度，排序追求精度，重排追求体验

<center>![../_images/recommendation_pipeline.svg](https://datawhalechina.github.io/fun-rec/_images/recommendation_pipeline.svg)</center>
<center>图2 推荐系统三阶流水线架构</center>

**推荐系统的最终目标不是单纯追求技术指标的最大化，而是构建一个能让所有参与方长期受益的健康生态**

## 第三章 精排模型

### 记忆与泛化——Wide&Deep模型

Wide部分是一个线性模型，能高效记忆那些显而易见的关联规则，输入包含原始特征和交叉特征

$$
y = w^Tx + b
$$

Deep部分是一个DNN，可以自动学习特征之间到底高阶、非线性关系，那些高维稀疏的类别特征通过一个嵌入层映射为低维、稠密的向量，这些嵌入向量与其他数值特征拼接在一起，送入多层神经网络中前向传播

$$
a^{(l+1)} = f(W^{(l)}a^{(l)} + b^{(l)})
$$

Wide & Deep模型通过联合训练，将两部分的输出结果结合起来进行最终的预测

### 特征交叉——二阶特征交叉
如何自动学习特征之间的交叉关系，而不用手工一个个去设计?
- **FM:** 给每个特征学一个向量表示，然后用向量内积来捕捉特征间的关系;
- **AFM注意力加权的交叉特征：**在FM的基础上引入了注意力机制，因为FM对所有特征交叉给予了相同的权重，但实际上不同交叉组合的重要性是不同的。
- **NFM交叉特征的深度学习：**探索如何更深入地利用交叉信息，将FM所捕获的二阶交叉信息作为原料输入给更强大的DNN
- **PNN：**在内积的基础上引入了外积，希望通过多种乘积操作来更全面地捕捉特征间的交互关系，但它的局限性是它把所有特征都当作同等重要；
- **FiBiNET:** 先学习每个特征的重要性权重，再根据权重来做特征交互，最后通过双线性交互来建模特征关系，可以争对性地处理重要特征；
- **DeepFM:** 将Wide&Deep模型中Wide部分替换为了一个无需任何人工干预的FM模型，实现端到端的训练且FM组件与Deep组件共享同一份特征嵌入。

### 特征交叉——高阶特征交叉
- **DCN(Deep & Cross Network) 残差连接的元素级交叉：**DCN通过引入Cross Network来替代Wide部分，从而明确地学习高阶特征交互，其由多个交叉层堆叠而成，每一层都保留了与原始输入特征的直接交互；
- **xDeepFM 向量级别的特征交互：**xDeepFM针对DCN在元素级别交叉的缺点进行改进，提出了CIN实现向量级别的特征交互；
- **AutoInt 自注意力的自适应交互：**AutoInt采用Transformer的自注意力机制，让模型自适应学习高阶特征交互，解决DCN和xDeepFM交互方式比较固定的问题，其使用多头自注意力机制计算任意两个特征嵌入向量之间的相关性得分，该得分决定了特征的贡献以及交互强度。

